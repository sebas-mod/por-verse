import fs from 'fs'
import fetch from 'node-fetch'

const file = './database/pokemon.json'

async function actualizarPokemons() {
  try {
    console.log('üîç Obteniendo lista de Pok√©mon...')
    const res = await fetch('https://pokeapi.co/api/v2/pokemon?limit=1008')
    const data = await res.json()
    const lista = {}

    for (const p of data.results) {
      try {
        const info = await fetch(p.url).then(r => r.json())
        lista[info.name] = {
          id: info.id,
          nombre: info.name.charAt(0).toUpperCase() + info.name.slice(1),
          tipo: info.types.map(t => t.type.name),
          nivel: 5,
          ataques: info.moves.slice(0, 4).map(a => a.move.name),
          imagen: info.sprites.front_default
        }
        console.log(`‚úÖ Guardado ${info.name}`)
      } catch (err) {
        console.log(`‚ö†Ô∏è Error al obtener datos de ${p.name}: ${err.message}`)
      }
    }

    fs.writeFileSync(file, JSON.stringify(lista, null, 2))
    console.log(`üóÇÔ∏è Se guardaron ${Object.keys(lista).length} Pok√©mon en ${file}`)
  } catch (err) {
    console.error('‚ùå Error general al actualizar Pok√©mon:', err)
  }
}

actualizarPokemons()
